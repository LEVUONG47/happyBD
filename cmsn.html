<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÇ Nh·∫≠p M·∫≠t Kh·∫©u</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Quicksand', sans-serif;
      min-height: 100vh;
      overflow: hidden;
    }

    /* ===== PASSWORD SCREEN ===== */
    .password-screen {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #ffeef8 0%, #fff5f8 50%, #f8f0ff 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      transition: opacity 0.5s, visibility 0.5s;
    }
    .password-screen.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .pass-title {
      font-size: clamp(1.5rem, 5vw, 2.2rem);
      font-weight: 700;
      color: #333;
      margin-bottom: 30px;
      text-align: center;
    }

    .pass-container {
      display: flex;
      gap: 30px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }

    .avatar-box {
      width: 180px;
      height: 200px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .avatar-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .keypad-section {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .pass-display {
      width: 180px;
      height: 50px;
      background: #fff;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      letter-spacing: 8px;
      color: #333;
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 50px);
      gap: 8px;
    }

    .key {
      width: 50px;
      height: 50px;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      font-family: 'Quicksand', sans-serif;
    }
    .key-num {
      background: #f5f5f5;
      color: #333;
    }
    .key-num:hover { background: #e8e8e8; }
    .key-action {
      background: #e0e0e0;
      color: #666;
    }
    .key-action:hover { background: #d0d0d0; }
    .key:active { transform: scale(0.95); }

    .pass-hint {
      font-size: 14px;
      color: #888;
      text-align: center;
      margin-top: 15px;
    }

    .error-msg {
      color: #ff4757;
      font-size: 14px;
      margin-top: 10px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .error-msg.show { opacity: 1; }
</style>
</head>
<body>
<!-- Password Screen -->
<div class="password-screen" id="passwordScreen">
  <h1 class="pass-title">NH·∫¨P PASS ƒêI NG∆Ø·ªúI ƒê·∫∏P üíï</h1>
  <div class="pass-container">
    <div class="avatar-box">
      <img src="https://i.pinimg.com/564x/a4/9e/6b/a49e6b3a4d5c8e9f0a1b2c3d4e5f6a7b.jpg" alt="Avatar" id="avatarImg">
    </div>
    <div class="keypad-section">
      <div class="pass-display" id="passDisplay">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>
      <div class="keypad">
        <button class="key key-num" data-num="1">1</button>
        <button class="key key-num" data-num="2">2</button>
        <button class="key key-num" data-num="3">3</button>
        <button class="key key-num" data-num="4">4</button>
        <button class="key key-num" data-num="5">5</button>
        <button class="key key-num" data-num="6">6</button>
        <button class="key key-num" data-num="7">7</button>
        <button class="key key-num" data-num="8">8</button>
        <button class="key key-num" data-num="9">9</button>
        <button class="key key-action" id="keyCheck">‚úì</button>
        <button class="key key-num" data-num="0">0</button>
        <button class="key key-action" id="keyDelete">‚úï</button>
      </div>
      <div class="error-msg" id="errorMsg">Sai m·∫≠t kh·∫©u r·ªìi! üò¢</div>
    </div>
  </div>
  <p class="pass-hint">G·ª£i √Ω: Ng√†y sinh c·ªßa ng∆∞·ªùi ·∫•y (ddmmyyyy)</p>
</div>

<style>
    /* ===== GALAXY SCREEN ===== */
    .galaxy-screen {
      position: fixed;
      inset: 0;
      background: #160016;
      display: none;
      z-index: 500;
    }
    .galaxy-screen.active { display: block; }

    #galaxyCanvas {
      position: absolute;
      inset: 0;
    }

    .birthday-text {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 600;
      color: #fff;
      font-family: 'Quicksand', cursive;
      max-width: 350px;
    }
    .birthday-text h2 {
      font-size: clamp(1.5rem, 4vw, 2.5rem);
      background: linear-gradient(90deg, #ff9a9e, #fecfef, #a18cd1);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 15px;
      text-shadow: 0 0 30px rgba(255, 154, 158, 0.5);
    }
    .birthday-text .typing {
      font-size: 16px;
      line-height: 1.8;
      color: rgba(255,255,255,0.9);
      min-height: 100px;
    }
    .birthday-text .cursor {
      display: inline-block;
      width: 2px;
      height: 1em;
      background: #fff;
      margin-left: 2px;
      animation: blink 0.8s infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }

    /* Photo orbit */
    .photo-orbit {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120px;
      height: 120px;
      z-index: 550;
    }
    .center-photo {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid rgba(255,255,255,0.3);
      box-shadow: 0 0 30px rgba(255, 154, 158, 0.5);
    }
    .center-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Floating photos */
    .floating-photos {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 520;
    }
    .float-photo {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 10px;
      overflow: hidden;
      border: 2px solid rgba(255,255,255,0.2);
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
      animation: floatPhoto 20s linear infinite;
    }
    .float-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    @keyframes floatPhoto {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(-100vh) rotate(360deg); }
    }

    /* Hearts */
    .hearts-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 510;
      overflow: hidden;
    }
    .heart {
      position: absolute;
      font-size: 20px;
      animation: heartFloat 8s linear infinite;
      opacity: 0.7;
    }
    @keyframes heartFloat {
      0% { transform: translateY(100vh) scale(0); opacity: 0; }
      10% { opacity: 0.7; transform: scale(1); }
      90% { opacity: 0.7; }
      100% { transform: translateY(-100px) scale(0.5); opacity: 0; }
    }

    @media (max-width: 600px) {
      .pass-container { flex-direction: column; }
      .birthday-text { max-width: 90%; }
    }
  </style>

<!-- Galaxy Screen -->
<div class="galaxy-screen" id="galaxyScreen">
  <div class="birthday-text">
    <h2>üéÇ Happy Birthday! üéÇ</h2>
    <div class="typing" id="typingText"></div>
  </div>
  
  <div class="photo-orbit">
    <div class="center-photo">
      <img src="https://i.pinimg.com/564x/a4/9e/6b/a49e6b3a4d5c8e9f0a1b2c3d4e5f6a7b.jpg" alt="Center" id="centerImg">
    </div>
  </div>
  
  <div class="floating-photos" id="floatingPhotos"></div>
  <div class="hearts-container" id="heartsContainer"></div>
</div>

<script type="module">
import * as THREE from "https://cdn.skypack.dev/three@0.136.0";
import { OrbitControls } from "https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls";

// ============ CONFIG ============
const CONFIG = {
  password: "15012000",  // ƒê·ªïi th√†nh ng√†y sinh: ddmmyyyy
  birthdayName: "Em y√™u",
  wishes: [
    "Ch√∫c em sinh nh·∫≠t vui v·∫ª! üéâ",
    "Mong em lu√¥n kh·ªèe m·∫°nh, h·∫°nh ph√∫c...",
    "Tu·ªïi m·ªõi nhi·ªÅu ni·ªÅm vui, th√†nh c√¥ng!",
    "Em l√† ng∆∞·ªùi tuy·ªát v·ªùi nh·∫•t! üíï",
    "Y√™u em nhi·ªÅu l·∫Øm! ü•∞"
  ],
  // Thay ƒë·ªïi ·∫£nh ·ªü ƒë√¢y
  photos: [
    "https://i.pinimg.com/564x/a4/9e/6b/a49e6b3a4d5c8e9f0a1b2c3d4e5f6a7b.jpg",
    "https://i.pinimg.com/564x/b5/0f/7c/b50f7c4d6e8f9a0b1c2d3e4f5a6b7c8d.jpg",
    "https://i.pinimg.com/564x/c6/1a/8d/c61a8d5e9f0a1b2c3d4e5f6a7b8c9d0e.jpg",
    "https://i.pinimg.com/564x/d7/2b/9e/d72b9e6f0a1b2c3d4e5f6a7b8c9d0e1f.jpg",
    "https://i.pinimg.com/564x/e8/3c/af/e83caf7a1b2c3d4e5f6a7b8c9d0e1f2a.jpg"
  ]
};

// ============ PASSWORD LOGIC ============
let enteredPass = "";
const passDisplay = document.getElementById("passDisplay");
const errorMsg = document.getElementById("errorMsg");
const passwordScreen = document.getElementById("passwordScreen");
const galaxyScreen = document.getElementById("galaxyScreen");

function updateDisplay() {
  const dots = "‚Ä¢".repeat(enteredPass.length) + "‚Ä¢".repeat(Math.max(0, 8 - enteredPass.length));
  passDisplay.textContent = enteredPass.length > 0 ? dots.substring(0, 8) : "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢";
}

document.querySelectorAll(".key-num").forEach(btn => {
  btn.addEventListener("click", () => {
    if (enteredPass.length < 8) {
      enteredPass += btn.dataset.num;
      updateDisplay();
      errorMsg.classList.remove("show");
    }
  });
});

document.getElementById("keyDelete").addEventListener("click", () => {
  enteredPass = enteredPass.slice(0, -1);
  updateDisplay();
  errorMsg.classList.remove("show");
});

document.getElementById("keyCheck").addEventListener("click", () => {
  if (enteredPass === CONFIG.password) {
    passwordScreen.classList.add("hidden");
    setTimeout(() => {
      galaxyScreen.classList.add("active");
      initGalaxy();
      startBirthdayShow();
    }, 500);
  } else {
    errorMsg.classList.add("show");
    enteredPass = "";
    updateDisplay();
  }
});

// ============ GALAXY (THREE.js) ============
let scene, camera, renderer, controls, points;
let gu = { time: { value: 0 } };

function initGalaxy() {
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x160016);
  
  camera = new THREE.PerspectiveCamera(60, innerWidth / innerHeight, 1, 1000);
  camera.position.set(0, 4, 21);
  
  renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(innerWidth, innerHeight);
  galaxyScreen.appendChild(renderer.domElement);
  
  controls = new OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.enablePan = false;
  controls.autoRotate = true;
  controls.autoRotateSpeed = 0.5;

  // Create galaxy particles
  let sizes = [];
  let shift = [];
  let pts = [];

  const pushShift = () => {
    shift.push(
      Math.random() * Math.PI,
      Math.random() * Math.PI * 2,
      (Math.random() * 0.9 + 0.1) * Math.PI * 0.1,
      Math.random() * 0.9 + 0.1
    );
  };

  // Sphere particles
  for (let i = 0; i < 25000; i++) {
    sizes.push(Math.random() * 1.5 + 0.5);
    pushShift();
    pts.push(new THREE.Vector3().randomDirection().multiplyScalar(Math.random() * 0.5 + 9.5));
  }

  // Disk particles
  for (let i = 0; i < 50000; i++) {
    let r = 10, R = 40;
    let rand = Math.pow(Math.random(), 1.5);
    let radius = Math.sqrt(R * R * rand + (1 - rand) * r * r);
    pts.push(new THREE.Vector3().setFromCylindricalCoords(radius, Math.random() * 2 * Math.PI, (Math.random() - 0.5) * 2));
    sizes.push(Math.random() * 1.5 + 0.5);
    pushShift();
  }

  let g = new THREE.BufferGeometry().setFromPoints(pts);
  g.setAttribute("sizes", new THREE.Float32BufferAttribute(sizes, 1));
  g.setAttribute("shift", new THREE.Float32BufferAttribute(shift, 4));

  let m = new THREE.PointsMaterial({
    size: 0.1,
    transparent: true,
    blending: THREE.AdditiveBlending,
    onBeforeCompile: shader => {
      shader.uniforms.time = gu.time;
      shader.vertexShader = `
        uniform float time;
        attribute float sizes;
        attribute vec4 shift;
        varying vec3 vColor;
        ${shader.vertexShader}
      `.replace(
        `gl_PointSize = size;`,
        `gl_PointSize = size * sizes;`
      ).replace(
        `#include <color_vertex>`,
        `#include <color_vertex>
          float d = length(abs(position) / vec3(40., 10., 40));
          d = clamp(d, 0., 1.);
          vColor = mix(vec3(255., 154., 158.), vec3(161., 140., 209.), d) / 255.;
        `
      ).replace(
        `#include <begin_vertex>`,
        `#include <begin_vertex>
          float t = time;
          float moveT = mod(shift.x + shift.z * t, PI2);
          float moveS = mod(shift.y + shift.z * t, PI2);
          transformed += vec3(cos(moveS) * sin(moveT), cos(moveT), sin(moveS) * sin(moveT)) * shift.a;
        `
      );
      shader.fragmentShader = `
        varying vec3 vColor;
        ${shader.fragmentShader}
      `.replace(
        `#include <clipping_planes_fragment>`,
        `#include <clipping_planes_fragment>
          float d = length(gl_PointCoord.xy - 0.5);
          if (d > 0.5) discard;
        `
      ).replace(
        `vec4 diffuseColor = vec4( diffuse, opacity );`,
        `vec4 diffuseColor = vec4( vColor, smoothstep(0.5, 0.2, d) * 0.5 + 0.5 );`
      );
    }
  });

  points = new THREE.Points(g, m);
  points.rotation.order = "ZYX";
  points.rotation.z = 0.2;
  scene.add(points);

  window.addEventListener("resize", () => {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
  });

  const clock = new THREE.Clock();
  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    let t = clock.getElapsedTime() * 0.5;
    gu.time.value = t * Math.PI;
    points.rotation.y = t * 0.05;
    renderer.render(scene, camera);
  }
  animate();
}

// ============ BIRTHDAY SHOW ============
function startBirthdayShow() {
  // Floating photos
  createFloatingPhotos();
  
  // Hearts
  createHearts();
  
  // Typing effect
  typeWishes();
}

function createFloatingPhotos() {
  const container = document.getElementById("floatingPhotos");
  CONFIG.photos.forEach((src, i) => {
    const photo = document.createElement("div");
    photo.className = "float-photo";
    photo.innerHTML = `<img src="${src}" alt="Photo ${i+1}">`;
    photo.style.left = Math.random() * 80 + 10 + "%";
    photo.style.animationDuration = 15 + Math.random() * 10 + "s";
    photo.style.animationDelay = Math.random() * -20 + "s";
    photo.style.width = 50 + Math.random() * 40 + "px";
    photo.style.height = photo.style.width;
    container.appendChild(photo);
  });
  
  // Add more copies
  for (let i = 0; i < 10; i++) {
    const photo = document.createElement("div");
    photo.className = "float-photo";
    photo.innerHTML = `<img src="${CONFIG.photos[i % CONFIG.photos.length]}" alt="Photo">`;
    photo.style.left = Math.random() * 90 + 5 + "%";
    photo.style.animationDuration = 18 + Math.random() * 12 + "s";
    photo.style.animationDelay = Math.random() * -25 + "s";
    photo.style.width = 40 + Math.random() * 50 + "px";
    photo.style.height = photo.style.width;
    container.appendChild(photo);
  }
}

function createHearts() {
  const container = document.getElementById("heartsContainer");
  const hearts = ["üíï", "üíñ", "üíó", "üíù", "‚ù§Ô∏è", "ü©∑", "‚ú®", "üåü"];
  
  function addHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
    heart.style.left = Math.random() * 100 + "%";
    heart.style.animationDuration = 6 + Math.random() * 4 + "s";
    heart.style.fontSize = 15 + Math.random() * 20 + "px";
    container.appendChild(heart);
    setTimeout(() => heart.remove(), 10000);
  }
  
  setInterval(addHeart, 500);
  for (let i = 0; i < 15; i++) setTimeout(addHeart, i * 200);
}

function typeWishes() {
  const typingEl = document.getElementById("typingText");
  const fullText = `G·ª≠i ${CONFIG.birthdayName}! üíï\n\n` + CONFIG.wishes.join("\n\n");
  let i = 0;
  
  function type() {
    if (i < fullText.length) {
      const char = fullText.charAt(i);
      if (char === "\n") {
        typingEl.innerHTML += "<br>";
      } else {
        typingEl.innerHTML += char;
      }
      i++;
      setTimeout(type, 50);
    } else {
      typingEl.innerHTML += '<span class="cursor"></span>';
    }
  }
  
  setTimeout(type, 1000);
}

// Set avatar images
document.getElementById("avatarImg").src = CONFIG.photos[0];
document.getElementById("centerImg").src = CONFIG.photos[0];
</script>
</body>
</html>